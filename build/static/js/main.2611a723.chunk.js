(this.webpackJsonpfncs=this.webpackJsonpfncs||[]).push([[0],{27:function(t,e,a){t.exports=a(46)},32:function(t,e,a){},39:function(t,e,a){},40:function(t,e,a){},41:function(t,e,a){},42:function(t,e,a){},43:function(t,e,a){},46:function(t,e,a){"use strict";a.r(e);var n=a(0),r=a.n(n),i=a(23),s=a.n(i),o=a(1),l=a(2),c=a(4),u=a(3),m=a(5),p=a(8),h=(a(32),function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"render",value:function(){return r.a.createElement("div",{className:"topnav"},r.a.createElement("div",{style:{display:this.props.connected?"none":"block"}},r.a.createElement(p.b,{to:"/"},"Accueil"),r.a.createElement(p.b,{to:"/login"},"Connexion")),r.a.createElement("div",{style:{display:this.props.connected?"block":"none"}},r.a.createElement(p.b,{to:"/purchase"},"Accueil"),r.a.createElement(p.b,{to:"/profile"},"Mon compte"),r.a.createElement(p.b,{to:"/logout"},"D\xe9connexion")))}}]),e}(n.Component)),d=a(12),v=a.n(d),f=a(15),b=(a(39),function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={email:"eve.holt@reqres.in",password:"cityslicka"},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"onChangeEmail",value:function(t){this.setState({email:t.target.value})}},{key:"onChangePassword",value:function(t){this.setState({password:t.target.value})}},{key:"login",value:function(){var t=Object(f.a)(v.a.mark((function t(e){var a,n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=this.fetchLogin(),t.next=3,a;case 3:return n=t.sent.json(),t.next=6,a;case 6:if(t.t0=t.sent.status,200===t.t0){t.next=9;break}return t.abrupt("return");case 9:return t.t1=localStorage,t.next=12,n;case 12:t.t2=t.sent.token,t.t1.setItem.call(t.t1,"auth_token",t.t2),localStorage.setItem("email",this.state.email),this.props.setConnected(!0);case 16:case"end":return t.stop()}}),t,this)})));return function(e){return t.apply(this,arguments)}}()},{key:"fetchLogin",value:function(){return fetch("https://reqres.in/api/login",{method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({email:this.state.email,password:this.state.password})})}},{key:"onSubmitForm",value:function(t){this.login(t),t.preventDefault()}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},this.props.handleGoHomeIfUserIsConnected,r.a.createElement("div",{className:"row"},r.a.createElement("form",{id:"formLogin",onSubmit:this.onSubmitForm.bind(this)},r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Email",defaultValue:this.state.email,onChange:this.onChangeEmail.bind(this)}),r.a.createElement("br",null),r.a.createElement("input",{type:"password",className:"form-control",placeholder:"Mot de passe",defaultValue:this.state.password,onChange:this.onChangePassword.bind(this)}),r.a.createElement("br",null),r.a.createElement("button",{type:"submit",className:"form-control"},"login"))))}}]),e}(n.Component)),S=a(11),y=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"componentDidMount",value:function(){localStorage.clear(),this.props.setConnected(!1)}},{key:"render",value:function(){return r.a.createElement(S.a,{to:"/"})}}]),e}(n.Component),g=a(19),E=(a(40),a(41),function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={priceTicket:20,isBought:!1},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getListStationsPurchased",value:function(){var t=localStorage.getItem("stations");return t?JSON.parse(t):[]}},{key:"saveStationBought",value:function(){var t=this.getListStationsPurchased(),e=[this.props.arrivalStation,this.props.departureStation,this.getPriceReduction()];t.push(e),localStorage.setItem("stations",JSON.stringify(t))}},{key:"onClickBuyingButton",value:function(t){this.saveStationBought(),this.setState({isBought:!0}),t.preventDefault()}},{key:"getPriceReduction",value:function(){return localStorage.getItem("promoCode")?this.state.priceTicket/2:this.state.priceTicket}},{key:"getDisplayPrice",value:function(){return r.a.createElement("div",null,r.a.createElement("p",{style:{textDecoration:this.getPriceReduction()!==this.state.priceTicket?"line-through":""}},this.state.priceTicket,"\u20ac"),r.a.createElement("p",{style:{display:this.getPriceReduction()!==this.state.priceTicket?"block":"none"}},"Prix apr\xe8s r\xe9duction : ",this.getPriceReduction(),"\u20ac"))}},{key:"ticketIsBought",value:function(){return this.state.isBought?r.a.createElement(S.a,{to:"/profile"}):r.a.createElement("div",null)}},{key:"render",value:function(){return r.a.createElement("div",{className:"row schedule"},this.ticketIsBought(),r.a.createElement("div",{className:"col-lg-3"},r.a.createElement("p",null,this.props.departureStation),r.a.createElement("hr",null),r.a.createElement("p",null,this.props.arrivalStation)),r.a.createElement("div",{className:"col-lg-3"},this.getDisplayPrice()),r.a.createElement("form",{onSubmit:this.onClickBuyingButton.bind(this),className:"col-lg-6"},r.a.createElement("input",{type:"submit",value:"Acheter",className:"form-control"})))}}]),e}(n.Component)),k=(a(42),function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={stationList:[]},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"computeStation",value:function(){for(var t=[],e=0;e<10;e++)t.push("9h00");this.setState({stationList:t})}},{key:"componentDidMount",value:function(){this.computeStation()}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{id:"purchaseBlock",className:"col-lg-12"},this.state.stationList.map((function(e,a){return r.a.createElement(E,{key:a,departureStation:t.props.departureStation,arrivalStation:t.props.arrivalStation})})))}}]),e}(n.Component)),C=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={departureStation:"",arrivalStation:"",departureStationSave:"",arrivalStationSave:"",departureListStations:[],arrivalListStations:[],displayDepartureList:!1,displayArrivalList:!1,searchEnabled:!1},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"displayDepartureListStations",value:function(){var t=Object(f.a)(v.a.mark((function t(){var e,a,n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.state.departureStation){t.next=3;break}return this.setState({departureListStations:[]}),t.abrupt("return");case 3:return e=this.fetchSNCF(this.state.departureStation),t.next=6,e;case 6:return a=t.sent.json(),t.next=9,a;case 9:return t.t0=function(t){return t.fields.pltf_commune_libellemin},n=t.sent.records.map(t.t0),t.t1=this,t.t2=g.a,t.t3=Set,t.next=16,n;case 16:t.t4=t.sent,t.t5=new t.t3(t.t4),t.t6=(0,t.t2)(t.t5),t.t7={departureListStations:t.t6},t.t1.setState.call(t.t1,t.t7);case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"displayArrivalListStations",value:function(){var t=Object(f.a)(v.a.mark((function t(){var e,a,n;return v.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==this.state.arrivalStation){t.next=3;break}return this.setState({arrivalListStations:[]}),t.abrupt("return");case 3:return e=this.fetchSNCF(this.state.arrivalStation),t.next=6,e;case 6:return a=t.sent.json(),t.next=9,a;case 9:return t.t0=function(t){return t.fields.pltf_commune_libellemin},n=t.sent.records.map(t.t0),t.t1=this,t.t2=g.a,t.t3=Set,t.next=16,n;case 16:t.t4=t.sent,t.t5=new t.t3(t.t4),t.t6=(0,t.t2)(t.t5),t.t7={arrivalListStations:t.t6},t.t1.setState.call(t.t1,t.t7);case 21:case"end":return t.stop()}}),t,this)})));return function(){return t.apply(this,arguments)}}()},{key:"fetchSNCF",value:function(t){return fetch("https://ressources.data.sncf.com/api/records/1.0/search/?dataset=referentiel-gares-voyageurs&q="+t)}},{key:"onChangeDepartureStation",value:function(t){this.setState({departureStation:t.target.value,displayDepartureList:!0})}},{key:"onChangeArrivalStation",value:function(t){this.setState({arrivalStation:t.target.value,displayArrivalList:!0})}},{key:"handleCheckDeparture",value:function(t){this.setState({departureStation:t.target.textContent,displayDepartureList:!1})}},{key:"handleCheckArrival",value:function(t){this.setState({arrivalStation:t.target.textContent,displayArrivalList:!1})}},{key:"onSubmitForm",value:function(t){this.setState({departureStationSave:this.state.departureStation,arrivalStationSave:this.state.arrivalStation,searchEnabled:!0}),t.preventDefault()}},{key:"componentDidUpdate",value:function(t,e,a){this.state.departureStation!==e.departureStation&&(this.displayDepartureListStations(),this.setState({displayArrivalList:!1})),this.state.arrivalStation!==e.arrivalStation&&(this.displayArrivalListStations(),this.setState({displayDepartureList:!1}))}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{id:"formStation",className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("form",{className:"col-lg-6",onSubmit:this.onSubmitForm.bind(this)},r.a.createElement("p",null,"Quel est votre trajet ?"),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Saisir votre gare de d\xe9part...",value:this.state.departureStation,onChange:this.onChangeDepartureStation.bind(this)}),r.a.createElement("br",null),r.a.createElement("input",{type:"text",className:"form-control",placeholder:"Saisir votre gare de d'arriv\xe9e...",value:this.state.arrivalStation,onChange:this.onChangeArrivalStation.bind(this)}),r.a.createElement("br",null),r.a.createElement("input",{type:"date",className:"form-control"}),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"form-control"})),r.a.createElement("div",{className:"col-lg-6"},r.a.createElement("ul",{className:"list-group",style:{display:this.state.displayDepartureList?"block":"none"}},this.state.departureListStations.map((function(e,a){return r.a.createElement("li",{onClick:t.handleCheckDeparture.bind(t),className:"list-group-item",key:a},e)}))),r.a.createElement("ul",{className:"list-group",style:{display:this.state.displayArrivalList?"block":"none"}},this.state.arrivalListStations.map((function(e,a){return r.a.createElement("li",{onClick:t.handleCheckArrival.bind(t),className:"list-group-item",key:a},e)}))))),r.a.createElement("div",{className:"row",style:{display:this.state.searchEnabled?"block":"none"}},r.a.createElement(k,{departureStation:this.state.departureStation,arrivalStation:this.state.arrivalStation})))}}]),e}(n.Component),j=(a(43),a(26)),O=a.n(j),N=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={promoCode:a.getPromoCode(),isCompleted:!1},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getPromoCode",value:function(){var t=localStorage.getItem("promoCode");return t||""}},{key:"onChangeInput",value:function(t){this.setState({promoCode:t.target.value})}},{key:"onClickButtonPromoCode",value:function(t){localStorage.setItem("promoCode",this.state.promoCode),this.setState({isCompleted:!0}),t.preventDefault()}},{key:"codePromoIsCompleted",value:function(){return this.state.isCompleted?r.a.createElement(S.a,{to:"/purchase"}):r.a.createElement("div",null)}},{key:"getCorrectInputPromoCode",value:function(){return null===localStorage.getItem("stations")?r.a.createElement("div",null,r.a.createElement("p",null,"Code de r\xe9duction"),r.a.createElement("input",{type:"text",className:"form-control",defaultValue:this.state.promoCode,onChange:this.onChangeInput.bind(this)}),r.a.createElement("br",null),r.a.createElement("input",{type:"submit",className:"form-control",value:"Appliquer"})):r.a.createElement("div",null,r.a.createElement("p",null,"Code de r\xe9duction"),r.a.createElement("input",{disabled:!0,type:"text",className:"form-control",defaultValue:this.state.promoCode,onChange:this.onChangeInput.bind(this)}),r.a.createElement("br",null),r.a.createElement("input",{disabled:!0,type:"submit",className:"form-control",value:"Appliquer"}))}},{key:"render",value:function(){return r.a.createElement("div",{className:"card"},this.codePromoIsCompleted(),r.a.createElement("img",{src:"https://www.gravatar.com/avatar/"+O()(this.props.email)+"?s=286",className:"card-img-top",alt:"hello"}),r.a.createElement("div",{className:"card-body"},r.a.createElement("h5",{className:"card-title"},this.props.firstName+" "+this.props.lastName),r.a.createElement("p",{className:"card-title"},this.props.email),r.a.createElement("hr",null),r.a.createElement("form",{onSubmit:this.onClickButtonPromoCode.bind(this)},this.getCorrectInputPromoCode())))}}]),e}(r.a.Component),I=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).state={tickets:a.getMyTickets()},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getMyTickets",value:function(){var t=localStorage.getItem("stations");return t?JSON.parse(t):[]}},{key:"displayTicket",value:function(t,e){return r.a.createElement("div",{key:e},r.a.createElement("p",null,t[0]," -> ",t[1],": ",t[2],"\u20ac"))}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"container"},r.a.createElement("h2",null,"Mes tickets"),this.state.tickets.map((function(e,a){return t.displayTicket(e,a)})))}}]),e}(n.Component),L=function(t){function e(){return Object(o.a)(this,e),Object(c.a)(this,Object(u.a)(e).apply(this,arguments))}return Object(m.a)(e,t),Object(l.a)(e,[{key:"getEmail",value:function(){var t=localStorage.getItem("email");return t||""}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row profile-block"},r.a.createElement("div",{className:"col-lg-4"},r.a.createElement(N,{firstName:"Maxime",lastName:"JOSIEN",email:this.getEmail()})),r.a.createElement("div",{className:"col-lg-6 border-tickets"},r.a.createElement(I,null))))}}]),e}(n.Component),x=function(t){function e(t){var a;return Object(o.a)(this,e),(a=Object(c.a)(this,Object(u.a)(e).call(this,t))).setConnected=function(t){a.setState({connected:t})},a.state={connected:!!localStorage.getItem("auth_token")},a}return Object(m.a)(e,t),Object(l.a)(e,[{key:"goHomeIfUserIsConnected",value:function(){return this.state.connected?r.a.createElement(S.a,{to:"/purchase"}):r.a.createElement("div",null)}},{key:"render",value:function(){var t=this;return r.a.createElement("div",{className:"App"},r.a.createElement(p.a,null,r.a.createElement(h,{connected:this.state.connected}),r.a.createElement(S.b,{path:"/login",render:function(){return r.a.createElement(b,{setConnected:t.setConnected,handleGoHomeIfUserIsConnected:t.goHomeIfUserIsConnected()})}}),r.a.createElement(S.b,{path:"/logout",render:function(){return r.a.createElement(y,{setConnected:t.setConnected})}}),r.a.createElement(S.b,{path:"/purchase",component:C}),r.a.createElement(S.b,{path:"/profile",component:L})))}}]),e}(n.Component);function w(){return r.a.createElement("div",{className:"App"},r.a.createElement(x,null))}a.d(e,"default",(function(){return w})),s.a.render(r.a.createElement(w,null),document.getElementById("root"))}},[[27,1,2]]]);
//# sourceMappingURL=main.2611a723.chunk.js.map